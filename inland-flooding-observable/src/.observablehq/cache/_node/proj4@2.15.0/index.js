import Dt from"../wkt-parser@1.4.0/index.js";import gs,{toPoint as vs,forward as bs}from"../mgrs@1.0.0/index.js";function $s(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var s=1;s<=60;++s)t("EPSG:"+(32600+s),"+proj=utm +zone="+s+" +datum=WGS84 +units=m"),t("EPSG:"+(32700+s),"+proj=utm +zone="+s+" +south +datum=WGS84 +units=m");t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}var J=1,V=2,Z=3,ws=4,jt=5,Ht=6378137,Ns=6356752314e-3,Kt=.0066943799901413165,rt=484813681109536e-20,f=Math.PI/2,Ps=.16666666666666666,As=.04722222222222222,Es=.022156084656084655,d=1e-10,S=.017453292519943295,F=57.29577951308232,b=Math.PI/4,ot=Math.PI*2,I=3.14159265359,B={};B.greenwich=0,B.lisbon=-9.131906111111,B.paris=2.337229166667,B.bogota=-74.080916666667,B.madrid=-3.687938888889,B.rome=12.452333333333,B.bern=7.439583333333,B.jakarta=106.807719444444,B.ferro=-17.666666666667,B.brussels=4.367975,B.stockholm=18.058277777778,B.athens=23.7163375,B.oslo=10.722916666667;var qs={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.01},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}},Xt=/[\s_\-\/\(\)]/g;function U(t,s){if(t[s])return t[s];for(var i=Object.keys(t),h=s.toLowerCase().replace(Xt,""),a=-1,e,r;++a<i.length;)if(e=i[a],r=e.toLowerCase().replace(Xt,""),r===h)return t[e]}function Lt(t){var s={},i=t.split("+").map(function(n){return n.trim()}).filter(function(n){return n}).reduce(function(n,o){var l=o.split("=");return l.push(!0),n[l[0].toLowerCase()]=l[1],n},{}),h,a,e,r={proj:"projName",datum:"datumCode",rf:function(n){s.rf=parseFloat(n)},lat_0:function(n){s.lat0=n*S},lat_1:function(n){s.lat1=n*S},lat_2:function(n){s.lat2=n*S},lat_ts:function(n){s.lat_ts=n*S},lon_0:function(n){s.long0=n*S},lon_1:function(n){s.long1=n*S},lon_2:function(n){s.long2=n*S},alpha:function(n){s.alpha=parseFloat(n)*S},gamma:function(n){s.rectified_grid_angle=parseFloat(n)},lonc:function(n){s.longc=n*S},x_0:function(n){s.x0=parseFloat(n)},y_0:function(n){s.y0=parseFloat(n)},k_0:function(n){s.k0=parseFloat(n)},k:function(n){s.k0=parseFloat(n)},a:function(n){s.a=parseFloat(n)},b:function(n){s.b=parseFloat(n)},r:function(n){s.a=s.b=parseFloat(n)},r_a:function(){s.R_A=!0},zone:function(n){s.zone=parseInt(n,10)},south:function(){s.utmSouth=!0},towgs84:function(n){s.datum_params=n.split(",").map(function(o){return parseFloat(o)})},to_meter:function(n){s.to_meter=parseFloat(n)},units:function(n){s.units=n;var o=U(qs,n);o&&(s.to_meter=o.to_meter)},from_greenwich:function(n){s.from_greenwich=n*S},pm:function(n){var o=U(B,n);s.from_greenwich=(o||parseFloat(n))*S},nadgrids:function(n){n==="@null"?s.datumCode="none":s.nadgrids=n},axis:function(n){var o="ewnsud";n.length===3&&o.indexOf(n.substr(0,1))!==-1&&o.indexOf(n.substr(1,1))!==-1&&o.indexOf(n.substr(2,1))!==-1&&(s.axis=n)},approx:function(){s.approx=!0}};for(h in i)a=i[h],h in r?(e=r[h],typeof e=="function"?e(a):s[e]=a):s[h]=a;return typeof s.datumCode=="string"&&s.datumCode!=="WGS84"&&(s.datumCode=s.datumCode.toLowerCase()),s}function R(t){var s=this;if(arguments.length===2){var i=arguments[1];typeof i=="string"?i.charAt(0)==="+"?R[t]=Lt(arguments[1]):R[t]=Dt(arguments[1]):R[t]=i}else if(arguments.length===1){if(Array.isArray(t))return t.map(function(h){Array.isArray(h)?R.apply(s,h):R(h)});if(typeof t=="string"){if(t in R)return R[t]}else"EPSG"in t?R["EPSG:"+t.EPSG]=t:"ESRI"in t?R["ESRI:"+t.ESRI]=t:"IAU2000"in t?R["IAU2000:"+t.IAU2000]=t:console.log(t);return}}$s(R);var wt=R;function ks(t){return typeof t=="string"}function Ss(t){return t in wt}var Is=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function Cs(t){return Is.some(function(s){return t.indexOf(s)>-1})}var Os=["3857","900913","3785","102113"];function Bs(t){var s=U(t,"authority");if(s){var i=U(s,"epsg");return i&&Os.indexOf(i)>-1}}function js(t){var s=U(t,"extension");if(s)return U(s,"proj4")}function Ls(t){return t[0]==="+"}function Gs(t){if(ks(t)){if(Ss(t))return wt[t];if(Cs(t)){var s=Dt(t);if(Bs(s))return wt["EPSG:3857"];var i=js(s);return i?Lt(i):s}if(Ls(t))return Lt(t)}else return t}var Rs=Gs;function Jt(t,s){t=t||{};var i,h;if(!s)return t;for(h in s)i=s[h],i!==void 0&&(t[h]=i);return t}function Q(t,s,i){var h=t*s;return i/Math.sqrt(1-h*h)}function lt(t){return t<0?-1:1}function x(t){return Math.abs(t)<=I?t:t-lt(t)*ot}function T(t,s,i){var h=t*i,a=.5*t;return h=Math.pow((1-h)/(1+h),a),Math.tan(.5*(f-s))/h}function Mt(t,s){for(var i=.5*t,h,a,e=f-2*Math.atan(s),r=0;r<=15;r++)if(h=t*Math.sin(e),a=f-2*Math.atan(s*Math.pow((1-h)/(1+h),i))-e,e+=a,Math.abs(a)<=1e-10)return e;return-9999}function Ts(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Q(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function zs(t){var s=t.x,i=t.y;if(i*F>90&&i*F<-90&&s*F>180&&s*F<-180)return null;var h,a;if(Math.abs(Math.abs(i)-f)<=d)return null;if(this.sphere)h=this.x0+this.a*this.k0*x(s-this.long0),a=this.y0+this.a*this.k0*Math.log(Math.tan(b+.5*i));else{var e=Math.sin(i),r=T(this.e,i,e);h=this.x0+this.a*this.k0*x(s-this.long0),a=this.y0-this.a*this.k0*Math.log(r)}return t.x=h,t.y=a,t}function Fs(t){var s=t.x-this.x0,i=t.y-this.y0,h,a;if(this.sphere)a=f-2*Math.atan(Math.exp(-i/(this.a*this.k0)));else{var e=Math.exp(-i/(this.a*this.k0));if(a=Mt(this.e,e),a===-9999)return null}return h=x(this.long0+s/(this.a*this.k0)),t.x=h,t.y=a,t}var Qs=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"],Us={init:Ts,forward:zs,inverse:Fs,names:Qs};function Ws(){}function Vt(t){return t}var Ds=["longlat","identity"],Hs={init:Ws,forward:Vt,inverse:Vt,names:Ds},Ks=[Us,Hs],Nt={},Pt=[];function Zt(t,s){var i=Pt.length;return t.names?(Pt[i]=t,t.names.forEach(function(h){Nt[h.toLowerCase()]=i}),this):(console.log(s),!0)}function Xs(t){if(!t)return!1;var s=t.toLowerCase();if(typeof Nt[s]<"u"&&Pt[Nt[s]])return Pt[Nt[s]]}function Js(){Ks.forEach(Zt)}var Vs={start:Js,add:Zt,get:Xs},v={};v.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"},v.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},v.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},v.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"},v.airy={a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},v.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},v.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},v.mod_airy={a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},v.andrae={a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},v.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},v.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},v.bessel={a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},v.bess_nam={a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},v.clrk66={a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},v.clrk80={a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},v.clrk80ign={a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},v.clrk58={a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},v.CPM={a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},v.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},v.engelis={a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},v.evrst30={a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},v.evrst48={a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},v.evrst56={a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},v.evrst69={a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},v.evrstSS={a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},v.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},v.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"},v.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"},v.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"},v.hough={a:6378270,rf:297,ellipseName:"Hough"},v.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},v.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"},v.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"},v.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"},v.new_intl={a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},v.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},v.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},v.SEasia={a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},v.walbeck={a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},v.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"},v.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"},v.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var Zs=v.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};v.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};function Ys(t,s,i,h){var a=t*t,e=s*s,r=(a-e)/a,n=0;h?(t*=1-r*(Ps+r*(As+r*Es)),a=t*t,r=0):n=Math.sqrt(r);var o=(a-e)/e;return{es:r,e:n,ep2:o}}function ti(t,s,i,h,a){if(!t){var e=U(v,h);e||(e=Zs),t=e.a,s=e.b,i=e.rf}return i&&!s&&(s=(1-1/i)*t),(i===0||Math.abs(t-s)<d)&&(a=!0,s=t),{a:t,b:s,rf:i,sphere:a}}var At={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};for(var si in At){var Yt=At[si];At[Yt.datumName]=Yt}var ii=At;function ai(t,s,i,h,a,e,r){var n={};return t===void 0||t==="none"?n.datum_type=jt:n.datum_type=ws,s&&(n.datum_params=s.map(parseFloat),(n.datum_params[0]!==0||n.datum_params[1]!==0||n.datum_params[2]!==0)&&(n.datum_type=J),n.datum_params.length>3&&(n.datum_params[3]!==0||n.datum_params[4]!==0||n.datum_params[5]!==0||n.datum_params[6]!==0)&&(n.datum_type=V,n.datum_params[3]*=rt,n.datum_params[4]*=rt,n.datum_params[5]*=rt,n.datum_params[6]=n.datum_params[6]/1e6+1)),r&&(n.datum_type=Z,n.grids=r),n.a=i,n.b=h,n.es=a,n.ep2=e,n}var hi=ai,ts={};function ei(t,s){var i=new DataView(s),h=oi(i),a=li(i,h),e=Mi(i,a,h),r={header:a,subgrids:e};return ts[t]=r,r}function ni(t){if(t===void 0)return null;var s=t.split(",");return s.map(ri)}function ri(t){if(t.length===0)return null;var s=t[0]==="@";return s&&(t=t.slice(1)),t==="null"?{name:"null",mandatory:!s,grid:null,isNull:!0}:{name:t,mandatory:!s,grid:ts[t]||null,isNull:!1}}function Y(t){return t/3600*Math.PI/180}function oi(t){var s=t.getInt32(8,!1);return s===11?!1:(s=t.getInt32(8,!0),s!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function li(t,s){return{nFields:t.getInt32(8,s),nSubgridFields:t.getInt32(24,s),nSubgrids:t.getInt32(40,s),shiftType:Gt(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,s),fromSemiMinorAxis:t.getFloat64(136,s),toSemiMajorAxis:t.getFloat64(152,s),toSemiMinorAxis:t.getFloat64(168,s)}}function Gt(t,s,i){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(s,i)))}function Mi(t,s,i){for(var h=176,a=[],e=0;e<s.nSubgrids;e++){var r=ci(t,h,i),n=fi(t,h,r,i),o=Math.round(1+(r.upperLongitude-r.lowerLongitude)/r.longitudeInterval),l=Math.round(1+(r.upperLatitude-r.lowerLatitude)/r.latitudeInterval);a.push({ll:[Y(r.lowerLongitude),Y(r.lowerLatitude)],del:[Y(r.longitudeInterval),Y(r.latitudeInterval)],lim:[o,l],count:r.gridNodeCount,cvs:ui(n)}),h+=176+r.gridNodeCount*16}return a}function ui(t){return t.map(function(s){return[Y(s.longitudeShift),Y(s.latitudeShift)]})}function ci(t,s,i){return{name:Gt(t,s+8,s+16).trim(),parent:Gt(t,s+24,s+24+8).trim(),lowerLatitude:t.getFloat64(s+72,i),upperLatitude:t.getFloat64(s+88,i),lowerLongitude:t.getFloat64(s+104,i),upperLongitude:t.getFloat64(s+120,i),latitudeInterval:t.getFloat64(s+136,i),longitudeInterval:t.getFloat64(s+152,i),gridNodeCount:t.getInt32(s+168,i)}}function fi(t,s,i,h){for(var a=s+176,e=16,r=[],n=0;n<i.gridNodeCount;n++){var o={latitudeShift:t.getFloat32(a+n*e,h),longitudeShift:t.getFloat32(a+n*e+4,h),latitudeAccuracy:t.getFloat32(a+n*e+8,h),longitudeAccuracy:t.getFloat32(a+n*e+12,h)};r.push(o)}return r}function tt(t,s){if(!(this instanceof tt))return new tt(t);s=s||function(l){if(l)throw l};var i=Rs(t);if(typeof i!="object"){s("Could not parse to valid json: "+t);return}var h=tt.projections.get(i.projName);if(!h){s("Could not get projection name from: "+t);return}if(i.datumCode&&i.datumCode!=="none"){var a=U(ii,i.datumCode);a&&(i.datum_params=i.datum_params||(a.towgs84?a.towgs84.split(","):null),i.ellps=a.ellipse,i.datumName=a.datumName?a.datumName:i.datumCode)}i.k0=i.k0||1,i.axis=i.axis||"enu",i.ellps=i.ellps||"wgs84",i.lat1=i.lat1||i.lat0;var e=ti(i.a,i.b,i.rf,i.ellps,i.sphere),r=Ys(e.a,e.b,e.rf,i.R_A),n=ni(i.nadgrids),o=i.datum||hi(i.datumCode,i.datum_params,e.a,e.b,r.es,r.ep2,n);Jt(this,i),Jt(this,h),this.a=e.a,this.b=e.b,this.rf=e.rf,this.sphere=e.sphere,this.es=r.es,this.e=r.e,this.ep2=r.ep2,this.datum=o,this.init(),s(null,this)}tt.projections=Vs,tt.projections.start();var ut=tt;function yi(t,s){return t.datum_type!==s.datum_type||t.a!==s.a||Math.abs(t.es-s.es)>5e-11?!1:t.datum_type===J?t.datum_params[0]===s.datum_params[0]&&t.datum_params[1]===s.datum_params[1]&&t.datum_params[2]===s.datum_params[2]:t.datum_type===V?t.datum_params[0]===s.datum_params[0]&&t.datum_params[1]===s.datum_params[1]&&t.datum_params[2]===s.datum_params[2]&&t.datum_params[3]===s.datum_params[3]&&t.datum_params[4]===s.datum_params[4]&&t.datum_params[5]===s.datum_params[5]&&t.datum_params[6]===s.datum_params[6]:!0}function ss(t,s,i){var h=t.x,a=t.y,e=t.z?t.z:0,r,n,o,l;if(a<-f&&a>-1.001*f)a=-f;else if(a>f&&a<1.001*f)a=f;else{if(a<-f)return{x:-1/0,y:-1/0,z:t.z};if(a>f)return{x:1/0,y:1/0,z:t.z}}return h>Math.PI&&(h-=2*Math.PI),n=Math.sin(a),l=Math.cos(a),o=n*n,r=i/Math.sqrt(1-s*o),{x:(r+e)*l*Math.cos(h),y:(r+e)*l*Math.sin(h),z:(r*(1-s)+e)*n}}function is(t,s,i,h){var a=1e-12,e=a*a,r=30,n,o,l,u,M,c,y,p,m,_,g,P,w,E=t.x,N=t.y,A=t.z?t.z:0,G,k,z;if(n=Math.sqrt(E*E+N*N),o=Math.sqrt(E*E+N*N+A*A),n/i<a){if(G=0,o/i<a)return k=f,z=-h,{x:t.x,y:t.y,z:t.z}}else G=Math.atan2(N,E);l=A/o,u=n/o,M=1/Math.sqrt(1-s*(2-s)*u*u),p=u*(1-s)*M,m=l*M,w=0;do w++,y=i/Math.sqrt(1-s*m*m),z=n*p+A*m-y*(1-s*m*m),c=s*y/(y+z),M=1/Math.sqrt(1-c*(2-c)*u*u),_=u*(1-c)*M,g=l*M,P=g*p-_*m,p=_,m=g;while(P*P>e&&w<r);return k=Math.atan(g/Math.abs(_)),{x:G,y:k,z}}function pi(t,s,i){if(s===J)return{x:t.x+i[0],y:t.y+i[1],z:t.z+i[2]};if(s===V){var h=i[0],a=i[1],e=i[2],r=i[3],n=i[4],o=i[5],l=i[6];return{x:l*(t.x-o*t.y+n*t.z)+h,y:l*(o*t.x+t.y-r*t.z)+a,z:l*(-n*t.x+r*t.y+t.z)+e}}}function mi(t,s,i){if(s===J)return{x:t.x-i[0],y:t.y-i[1],z:t.z-i[2]};if(s===V){var h=i[0],a=i[1],e=i[2],r=i[3],n=i[4],o=i[5],l=i[6],u=(t.x-h)/l,M=(t.y-a)/l,c=(t.z-e)/l;return{x:u+o*M-n*c,y:-o*u+M+r*c,z:n*u-r*M+c}}}function Et(t){return t===J||t===V}function di(t,s,i){if(yi(t,s)||t.datum_type===jt||s.datum_type===jt)return i;var h=t.a,a=t.es;if(t.datum_type===Z){var e=as(t,!1,i);if(e!==0)return;h=Ht,a=Kt}var r=s.a,n=s.b,o=s.es;if(s.datum_type===Z&&(r=Ht,n=Ns,o=Kt),a===o&&h===r&&!Et(t.datum_type)&&!Et(s.datum_type))return i;if(i=ss(i,a,h),Et(t.datum_type)&&(i=pi(i,t.datum_type,t.datum_params)),Et(s.datum_type)&&(i=mi(i,s.datum_type,s.datum_params)),i=is(i,o,r,n),s.datum_type===Z){var l=as(s,!0,i);if(l!==0)return}return i}function as(t,s,i){if(t.grids===null||t.grids.length===0)return console.log("Grid shift grids not found"),-1;var h={x:-i.x,y:i.y},a={x:Number.NaN,y:Number.NaN},e=[];t:for(var r=0;r<t.grids.length;r++){var n=t.grids[r];if(e.push(n.name),n.isNull){a=h;break}if(n.mandatory,n.grid===null){if(n.mandatory)return console.log("Unable to find mandatory grid '"+n.name+"'"),-1;continue}for(var o=n.grid.subgrids,l=0,u=o.length;l<u;l++){var M=o[l],c=(Math.abs(M.del[1])+Math.abs(M.del[0]))/1e4,y=M.ll[0]-c,p=M.ll[1]-c,m=M.ll[0]+(M.lim[0]-1)*M.del[0]+c,_=M.ll[1]+(M.lim[1]-1)*M.del[1]+c;if(!(p>h.y||y>h.x||_<h.y||m<h.x)&&(a=xi(h,s,M),!isNaN(a.x)))break t}}return isNaN(a.x)?(console.log("Failed to find a grid shift table for location '"+-h.x*F+" "+h.y*F+" tried: '"+e+"'"),-1):(i.x=-a.x,i.y=a.y,0)}function xi(t,s,i){var h={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return h;var a={x:t.x,y:t.y};a.x-=i.ll[0],a.y-=i.ll[1],a.x=x(a.x-Math.PI)+Math.PI;var e=hs(a,i);if(s){if(isNaN(e.x))return h;e.x=a.x-e.x,e.y=a.y-e.y;var r=9,n=1e-12,o,l;do{if(l=hs(e,i),isNaN(l.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}o={x:a.x-(l.x+e.x),y:a.y-(l.y+e.y)},e.x+=o.x,e.y+=o.y}while(r--&&Math.abs(o.x)>n&&Math.abs(o.y)>n);if(r<0)return console.log("Inverse grid shift iterator failed to converge."),h;h.x=x(e.x+i.ll[0]),h.y=e.y+i.ll[1]}else isNaN(e.x)||(h.x=t.x+e.x,h.y=t.y+e.y);return h}function hs(t,s){var i={x:t.x/s.del[0],y:t.y/s.del[1]},h={x:Math.floor(i.x),y:Math.floor(i.y)},a={x:i.x-1*h.x,y:i.y-1*h.y},e={x:Number.NaN,y:Number.NaN},r;if(h.x<0||h.x>=s.lim[0]||h.y<0||h.y>=s.lim[1])return e;r=h.y*s.lim[0]+h.x;var n={x:s.cvs[r][0],y:s.cvs[r][1]};r++;var o={x:s.cvs[r][0],y:s.cvs[r][1]};r+=s.lim[0];var l={x:s.cvs[r][0],y:s.cvs[r][1]};r--;var u={x:s.cvs[r][0],y:s.cvs[r][1]},M=a.x*a.y,c=a.x*(1-a.y),y=(1-a.x)*(1-a.y),p=(1-a.x)*a.y;return e.x=y*n.x+c*o.x+p*u.x+M*l.x,e.y=y*n.y+c*o.y+p*u.y+M*l.y,e}function es(t,s,i){var h=i.x,a=i.y,e=i.z||0,r,n,o,l={};for(o=0;o<3;o++)if(!(s&&o===2&&i.z===void 0))switch(o===0?(r=h,"ew".indexOf(t.axis[o])!==-1?n="x":n="y"):o===1?(r=a,"ns".indexOf(t.axis[o])!==-1?n="y":n="x"):(r=e,n="z"),t.axis[o]){case"e":l[n]=r;break;case"w":l[n]=-r;break;case"n":l[n]=r;break;case"s":l[n]=-r;break;case"u":i[n]!==void 0&&(l.z=r);break;case"d":i[n]!==void 0&&(l.z=-r);break;default:return null}return l}function ns(t){var s={x:t[0],y:t[1]};return t.length>2&&(s.z=t[2]),t.length>3&&(s.m=t[3]),s}function _i(t){rs(t.x),rs(t.y)}function rs(t){if(typeof Number.isFinite=="function"){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if(typeof t!="number"||t!==t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function gi(t,s){return(t.datum.datum_type===J||t.datum.datum_type===V||t.datum.datum_type===Z)&&s.datumCode!=="WGS84"||(s.datum.datum_type===J||s.datum.datum_type===V||s.datum.datum_type===Z)&&t.datumCode!=="WGS84"}function qt(t,s,i,h){var a;Array.isArray(i)?i=ns(i):i={x:i.x,y:i.y,z:i.z,m:i.m};var e=i.z!==void 0;if(_i(i),t.datum&&s.datum&&gi(t,s)&&(a=new ut("WGS84"),i=qt(t,a,i,h),t=a),h&&t.axis!=="enu"&&(i=es(t,!1,i)),t.projName==="longlat")i={x:i.x*S,y:i.y*S,z:i.z||0};else if(t.to_meter&&(i={x:i.x*t.to_meter,y:i.y*t.to_meter,z:i.z||0}),i=t.inverse(i),!i)return;if(t.from_greenwich&&(i.x+=t.from_greenwich),i=di(t.datum,s.datum,i),!!i)return s.from_greenwich&&(i={x:i.x-s.from_greenwich,y:i.y,z:i.z||0}),s.projName==="longlat"?i={x:i.x*F,y:i.y*F,z:i.z||0}:(i=s.forward(i),s.to_meter&&(i={x:i.x/s.to_meter,y:i.y/s.to_meter,z:i.z||0})),h&&s.axis!=="enu"?es(s,!0,i):(i&&!e&&delete i.z,i)}var os=ut("WGS84");function Rt(t,s,i,h){var a,e,r;return Array.isArray(i)?(a=qt(t,s,i,h)||{x:NaN,y:NaN},i.length>2?typeof t.name<"u"&&t.name==="geocent"||typeof s.name<"u"&&s.name==="geocent"?typeof a.z=="number"?[a.x,a.y,a.z].concat(i.slice(3)):[a.x,a.y,i[2]].concat(i.slice(3)):[a.x,a.y].concat(i.slice(2)):[a.x,a.y]):(e=qt(t,s,i,h),r=Object.keys(i),r.length===2||r.forEach(function(n){if(typeof t.name<"u"&&t.name==="geocent"||typeof s.name<"u"&&s.name==="geocent"){if(n==="x"||n==="y"||n==="z")return}else if(n==="x"||n==="y")return;e[n]=i[n]}),e)}function ls(t){return t instanceof ut?t:t.oProj?t.oProj:ut(t)}function vi(t,s,i){t=ls(t);var h=!1,a;return typeof s>"u"?(s=t,t=os,h=!0):(typeof s.x<"u"||Array.isArray(s))&&(i=s,s=t,t=os,h=!0),s=ls(s),i?Rt(t,s,i):(a={forward:function(e,r){return Rt(t,s,e,r)},inverse:function(e,r){return Rt(s,t,e,r)}},h&&(a.oProj=s),a)}var L=vi;function st(t,s,i){if(!(this instanceof st))return new st(t,s,i);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if(typeof t=="object")this.x=t.x,this.y=t.y,this.z=t.z||0;else if(typeof t=="string"&&typeof s>"u"){var h=t.split(",");this.x=parseFloat(h[0],10),this.y=parseFloat(h[1],10),this.z=parseFloat(h[2],10)||0}else this.x=t,this.y=s,this.z=i||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}st.fromMGRS=function(t){return new st(vs(t))},st.prototype.toMGRS=function(t){return bs([this.x,this.y],t)};var bi=st,$i=1,wi=.25,Ms=.046875,us=.01953125,cs=.01068115234375,Ni=.75,Pi=.46875,Ai=.013020833333333334,Ei=.007120768229166667,qi=.3645833333333333,ki=.005696614583333333,Si=.3076171875;function Tt(t){var s=[];s[0]=$i-t*(wi+t*(Ms+t*(us+t*cs))),s[1]=t*(Ni-t*(Ms+t*(us+t*cs)));var i=t*t;return s[2]=i*(Pi-t*(Ai+t*Ei)),i*=t,s[3]=i*(qi-t*ki),s[4]=i*t*Si,s}function it(t,s,i,h){return i*=s,s*=s,h[0]*t-i*(h[1]+s*(h[2]+s*(h[3]+s*h[4])))}var Ii=20;function zt(t,s,i){for(var h=1/(1-s),a=t,e=Ii;e;--e){var r=Math.sin(a),n=1-s*r*r;if(n=(it(a,r,Math.cos(a),i)-t)*(n*Math.sqrt(n))*h,a-=n,Math.abs(n)<d)return a}return a}function Ci(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=Tt(this.es),this.ml0=it(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function Oi(t){var s=t.x,i=t.y,h=x(s-this.long0),a,e,r,n=Math.sin(i),o=Math.cos(i);if(this.es){var l=o*h,u=Math.pow(l,2),M=this.ep2*Math.pow(o,2),c=Math.pow(M,2),y=Math.abs(o)>d?Math.tan(i):0,p=Math.pow(y,2),m=Math.pow(p,2);a=1-this.es*Math.pow(n,2),l=l/Math.sqrt(a);var _=it(i,n,o,this.en);e=this.a*(this.k0*l*(1+u/6*(1-p+M+u/20*(5-18*p+m+14*M-58*p*M+u/42*(61+179*m-m*p-479*p)))))+this.x0,r=this.a*(this.k0*(_-this.ml0+n*h*l/2*(1+u/12*(5-p+9*M+4*c+u/30*(61+m-58*p+270*M-330*p*M+u/56*(1385+543*m-m*p-3111*p))))))+this.y0}else{var g=o*Math.sin(h);if(Math.abs(Math.abs(g)-1)<d)return 93;if(e=.5*this.a*this.k0*Math.log((1+g)/(1-g))+this.x0,r=o*Math.cos(h)/Math.sqrt(1-Math.pow(g,2)),g=Math.abs(r),g>=1){if(g-1>d)return 93;r=0}else r=Math.acos(r);i<0&&(r=-r),r=this.a*this.k0*(r-this.lat0)+this.y0}return t.x=e,t.y=r,t}function Bi(t){var s,i,h,a,e=(t.x-this.x0)*(1/this.a),r=(t.y-this.y0)*(1/this.a);if(this.es)if(s=this.ml0+r/this.k0,i=zt(s,this.es,this.en),Math.abs(i)<f){var n=Math.sin(i),o=Math.cos(i),l=Math.abs(o)>d?Math.tan(i):0,u=this.ep2*Math.pow(o,2),M=Math.pow(u,2),c=Math.pow(l,2),y=Math.pow(c,2);s=1-this.es*Math.pow(n,2);var p=e*Math.sqrt(s)/this.k0,m=Math.pow(p,2);s=s*l,h=i-s*m/(1-this.es)*.5*(1-m/12*(5+3*c-9*u*c+u-4*M-m/30*(61+90*c-252*u*c+45*y+46*u-m/56*(1385+3633*c+4095*y+1574*y*c)))),a=x(this.long0+p*(1-m/6*(1+2*c+u-m/20*(5+28*c+24*y+8*u*c+6*u-m/42*(61+662*c+1320*y+720*y*c))))/o)}else h=f*lt(r),a=0;else{var _=Math.exp(e/this.k0),g=.5*(_-1/_),P=this.lat0+r/this.k0,w=Math.cos(P);s=Math.sqrt((1-Math.pow(w,2))/(1+Math.pow(g,2))),h=Math.asin(s),r<0&&(h=-h),g===0&&w===0?a=0:a=x(Math.atan2(g,w)+this.long0)}return t.x=a,t.y=h,t}var ji=["Fast_Transverse_Mercator","Fast Transverse Mercator"],kt={init:Ci,forward:Oi,inverse:Bi,names:ji};function fs(t){var s=Math.exp(t);return s=(s-1/s)/2,s}function j(t,s){t=Math.abs(t),s=Math.abs(s);var i=Math.max(t,s),h=Math.min(t,s)/(i||1);return i*Math.sqrt(1+Math.pow(h,2))}function Li(t){var s=1+t,i=s-1;return i===0?t:t*Math.log(s)/i}function Gi(t){var s=Math.abs(t);return s=Li(s*(1+s/(j(1,s)+1))),t<0?-s:s}function Ft(t,s){for(var i=2*Math.cos(2*s),h=t.length-1,a=t[h],e=0,r;--h>=0;)r=-e+i*a+t[h],e=a,a=r;return s+r*Math.sin(2*s)}function Ri(t,s){for(var i=2*Math.cos(s),h=t.length-1,a=t[h],e=0,r;--h>=0;)r=-e+i*a+t[h],e=a,a=r;return Math.sin(s)*r}function Ti(t){var s=Math.exp(t);return s=(s+1/s)/2,s}function ys(t,s,i){for(var h=Math.sin(s),a=Math.cos(s),e=fs(i),r=Ti(i),n=2*a*r,o=-2*h*e,l=t.length-1,u=t[l],M=0,c=0,y=0,p,m;--l>=0;)p=c,m=M,c=u,M=y,u=-p+n*c-o*M+t[l],y=-m+o*c+n*M;return n=h*r,o=a*e,[n*u-o*y,n*y+o*u]}function zi(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(kt.init.apply(this),this.forward=kt.forward,this.inverse=kt.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),s=t/(2-t),i=s;this.cgb[0]=s*(2+s*(-2/3+s*(-2+s*(116/45+s*(26/45+s*(-2854/675)))))),this.cbg[0]=s*(-2+s*(2/3+s*(4/3+s*(-82/45+s*(32/45+s*(4642/4725)))))),i=i*s,this.cgb[1]=i*(7/3+s*(-8/5+s*(-227/45+s*(2704/315+s*(2323/945))))),this.cbg[1]=i*(5/3+s*(-16/15+s*(-13/9+s*(904/315+s*(-1522/945))))),i=i*s,this.cgb[2]=i*(56/15+s*(-136/35+s*(-1262/105+s*(73814/2835)))),this.cbg[2]=i*(-26/15+s*(34/21+s*(8/5+s*(-12686/2835)))),i=i*s,this.cgb[3]=i*(4279/630+s*(-332/35+s*(-399572/14175))),this.cbg[3]=i*(1237/630+s*(-12/5+s*(-24832/14175))),i=i*s,this.cgb[4]=i*(4174/315+s*(-144838/6237)),this.cbg[4]=i*(-734/315+s*(109598/31185)),i=i*s,this.cgb[5]=i*(601676/22275),this.cbg[5]=i*(444337/155925),i=Math.pow(s,2),this.Qn=this.k0/(1+s)*(1+i*(1/4+i*(1/64+i/256))),this.utg[0]=s*(-.5+s*(2/3+s*(-37/96+s*(1/360+s*(81/512+s*(-96199/604800)))))),this.gtu[0]=s*(.5+s*(-2/3+s*(5/16+s*(41/180+s*(-127/288+s*(7891/37800)))))),this.utg[1]=i*(-1/48+s*(-1/15+s*(437/1440+s*(-46/105+s*(1118711/3870720))))),this.gtu[1]=i*(13/48+s*(-3/5+s*(557/1440+s*(281/630+s*(-1983433/1935360))))),i=i*s,this.utg[2]=i*(-17/480+s*(37/840+s*(209/4480+s*(-5569/90720)))),this.gtu[2]=i*(61/240+s*(-103/140+s*(15061/26880+s*(167603/181440)))),i=i*s,this.utg[3]=i*(-4397/161280+s*(11/504+s*(830251/7257600))),this.gtu[3]=i*(49561/161280+s*(-179/168+s*(6601661/7257600))),i=i*s,this.utg[4]=i*(-4583/161280+s*(108847/3991680)),this.gtu[4]=i*(34729/80640+s*(-3418889/1995840)),i=i*s,this.utg[5]=i*(-20648693/638668800),this.gtu[5]=i*(212378941/319334400);var h=Ft(this.cbg,this.lat0);this.Zb=-this.Qn*(h+Ri(this.gtu,2*h))}function Fi(t){var s=x(t.x-this.long0),i=t.y;i=Ft(this.cbg,i);var h=Math.sin(i),a=Math.cos(i),e=Math.sin(s),r=Math.cos(s);i=Math.atan2(h,r*a),s=Math.atan2(e*a,j(h,a*r)),s=Gi(Math.tan(s));var n=ys(this.gtu,2*i,2*s);i=i+n[0],s=s+n[1];var o,l;return Math.abs(s)<=2.623395162778?(o=this.a*(this.Qn*s)+this.x0,l=this.a*(this.Qn*i+this.Zb)+this.y0):(o=1/0,l=1/0),t.x=o,t.y=l,t}function Qi(t){var s=(t.x-this.x0)*(1/this.a),i=(t.y-this.y0)*(1/this.a);i=(i-this.Zb)/this.Qn,s=s/this.Qn;var h,a;if(Math.abs(s)<=2.623395162778){var e=ys(this.utg,2*i,2*s);i=i+e[0],s=s+e[1],s=Math.atan(fs(s));var r=Math.sin(i),n=Math.cos(i),o=Math.sin(s),l=Math.cos(s);i=Math.atan2(r*l,j(o,l*n)),s=Math.atan2(o,l*n),h=x(s+this.long0),a=Ft(this.cgb,i)}else h=1/0,a=1/0;return t.x=h,t.y=a,t}var Ui=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"],St={init:zi,forward:Fi,inverse:Qi,names:Ui};function Wi(t,s){if(t===void 0){if(t=Math.floor((x(s)+Math.PI)*30/Math.PI)+1,t<0)return 0;if(t>60)return 60}return t}var Di="etmerc";function Hi(){var t=Wi(this.zone,this.long0);if(t===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*S,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,St.init.apply(this),this.forward=St.forward,this.inverse=St.inverse}var Ki=["Universal Transverse Mercator System","utm"],Xi={init:Hi,names:Ki,dependsOn:Di};function Qt(t,s){return Math.pow((1-t)/(1+t),s)}var Ji=20;function Vi(){var t=Math.sin(this.lat0),s=Math.cos(this.lat0);s*=s,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*s*s/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+b)/(Math.pow(Math.tan(.5*this.lat0+b),this.C)*Qt(this.e*t,this.ratexp))}function Zi(t){var s=t.x,i=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*i+b),this.C)*Qt(this.e*Math.sin(i),this.ratexp))-f,t.x=this.C*s,t}function Yi(t){for(var s=1e-14,i=t.x/this.C,h=t.y,a=Math.pow(Math.tan(.5*h+b)/this.K,1/this.C),e=Ji;e>0&&(h=2*Math.atan(a*Qt(this.e*Math.sin(t.y),-.5*this.e))-f,!(Math.abs(h-t.y)<s));--e)t.y=h;return e?(t.x=i,t.y=h,t):null}var Ut={init:Vi,forward:Zi,inverse:Yi};function ta(){Ut.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function sa(t){var s,i,h,a;return t.x=x(t.x-this.long0),Ut.forward.apply(this,[t]),s=Math.sin(t.y),i=Math.cos(t.y),h=Math.cos(t.x),a=this.k0*this.R2/(1+this.sinc0*s+this.cosc0*i*h),t.x=a*i*Math.sin(t.x),t.y=a*(this.cosc0*s-this.sinc0*i*h),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function ia(t){var s,i,h,a,e;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,e=j(t.x,t.y)){var r=2*Math.atan2(e,this.R2);s=Math.sin(r),i=Math.cos(r),a=Math.asin(i*this.sinc0+t.y*s*this.cosc0/e),h=Math.atan2(t.x*s,e*this.cosc0*i-t.y*this.sinc0*s)}else a=this.phic0,h=0;return t.x=h,t.y=a,Ut.inverse.apply(this,[t]),t.x=x(t.x+this.long0),t}var aa=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"],ha={init:ta,forward:sa,inverse:ia,names:aa};function ea(t,s,i){return s*=i,Math.tan(.5*(f+t))*Math.pow((1-s)/(1+s),.5*i)}function na(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=d&&(this.k0=.5*(1+lt(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=d&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=d&&Math.abs(Math.cos(this.lat_ts))>d&&(this.k0=.5*this.cons*Q(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/T(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Q(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-f,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function ra(t){var s=t.x,i=t.y,h=Math.sin(i),a=Math.cos(i),e,r,n,o,l,u,M=x(s-this.long0);return Math.abs(Math.abs(s-this.long0)-Math.PI)<=d&&Math.abs(i+this.lat0)<=d?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*h+this.coslat0*a*Math.cos(M)),t.x=this.a*e*a*Math.sin(M)+this.x0,t.y=this.a*e*(this.coslat0*h-this.sinlat0*a*Math.cos(M))+this.y0,t):(r=2*Math.atan(this.ssfn_(i,h,this.e))-f,o=Math.cos(r),n=Math.sin(r),Math.abs(this.coslat0)<=d?(l=T(this.e,i*this.con,this.con*h),u=2*this.a*this.k0*l/this.cons,t.x=this.x0+u*Math.sin(s-this.long0),t.y=this.y0-this.con*u*Math.cos(s-this.long0),t):(Math.abs(this.sinlat0)<d?(e=2*this.a*this.k0/(1+o*Math.cos(M)),t.y=e*n):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*n+this.cosX0*o*Math.cos(M))),t.y=e*(this.cosX0*n-this.sinX0*o*Math.cos(M))+this.y0),t.x=e*o*Math.sin(M)+this.x0,t))}function oa(t){t.x-=this.x0,t.y-=this.y0;var s,i,h,a,e,r=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var n=2*Math.atan(r/(2*this.a*this.k0));return s=this.long0,i=this.lat0,r<=d?(t.x=s,t.y=i,t):(i=Math.asin(Math.cos(n)*this.sinlat0+t.y*Math.sin(n)*this.coslat0/r),Math.abs(this.coslat0)<d?this.lat0>0?s=x(this.long0+Math.atan2(t.x,-1*t.y)):s=x(this.long0+Math.atan2(t.x,t.y)):s=x(this.long0+Math.atan2(t.x*Math.sin(n),r*this.coslat0*Math.cos(n)-t.y*this.sinlat0*Math.sin(n))),t.x=s,t.y=i,t)}else if(Math.abs(this.coslat0)<=d){if(r<=d)return i=this.lat0,s=this.long0,t.x=s,t.y=i,t;t.x*=this.con,t.y*=this.con,h=r*this.cons/(2*this.a*this.k0),i=this.con*Mt(this.e,h),s=this.con*x(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else a=2*Math.atan(r*this.cosX0/(2*this.a*this.k0*this.ms1)),s=this.long0,r<=d?e=this.X0:(e=Math.asin(Math.cos(a)*this.sinX0+t.y*Math.sin(a)*this.cosX0/r),s=x(this.long0+Math.atan2(t.x*Math.sin(a),r*this.cosX0*Math.cos(a)-t.y*this.sinX0*Math.sin(a)))),i=-1*Mt(this.e,Math.tan(.5*(f+e)));return t.x=s,t.y=i,t}var la=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)","Polar_Stereographic"],Ma={init:na,forward:ra,inverse:oa,names:la,ssfn_:ea};function ua(){var t=this.lat0;this.lambda0=this.long0;var s=Math.sin(t),i=this.a,h=this.rf,a=1/h,e=2*a-Math.pow(a,2),r=this.e=Math.sqrt(e);this.R=this.k0*i*Math.sqrt(1-e)/(1-e*Math.pow(s,2)),this.alpha=Math.sqrt(1+e/(1-e)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(s/this.alpha);var n=Math.log(Math.tan(Math.PI/4+this.b0/2)),o=Math.log(Math.tan(Math.PI/4+t/2)),l=Math.log((1+r*s)/(1-r*s));this.K=n-this.alpha*o+this.alpha*r/2*l}function ca(t){var s=Math.log(Math.tan(Math.PI/4-t.y/2)),i=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),h=-this.alpha*(s+i)+this.K,a=2*(Math.atan(Math.exp(h))-Math.PI/4),e=this.alpha*(t.x-this.lambda0),r=Math.atan(Math.sin(e)/(Math.sin(this.b0)*Math.tan(a)+Math.cos(this.b0)*Math.cos(e))),n=Math.asin(Math.cos(this.b0)*Math.sin(a)-Math.sin(this.b0)*Math.cos(a)*Math.cos(e));return t.y=this.R/2*Math.log((1+Math.sin(n))/(1-Math.sin(n)))+this.y0,t.x=this.R*r+this.x0,t}function fa(t){for(var s=t.x-this.x0,i=t.y-this.y0,h=s/this.R,a=2*(Math.atan(Math.exp(i/this.R))-Math.PI/4),e=Math.asin(Math.cos(this.b0)*Math.sin(a)+Math.sin(this.b0)*Math.cos(a)*Math.cos(h)),r=Math.atan(Math.sin(h)/(Math.cos(this.b0)*Math.cos(h)-Math.sin(this.b0)*Math.tan(a))),n=this.lambda0+r/this.alpha,o=0,l=e,u=-1e3,M=0;Math.abs(l-u)>1e-7;){if(++M>20)return;o=1/this.alpha*(Math.log(Math.tan(Math.PI/4+e/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(l))/2)),u=l,l=2*Math.atan(Math.exp(o))-Math.PI/2}return t.x=n,t.y=l,t}var ya=["somerc"],pa={init:ua,forward:ca,inverse:fa,names:ya},at=1e-7;function ma(t){var s=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],i=typeof t.PROJECTION=="object"?Object.keys(t.PROJECTION)[0]:t.PROJECTION;return"no_uoff"in t||"no_off"in t||s.indexOf(i)!==-1}function da(){var t,s,i,h,a,e,r,n,o,l,u=0,M,c=0,y=0,p=0,m=0,_=0,g=0;this.no_off=ma(this),this.no_rot="no_rot"in this;var P=!1;"alpha"in this&&(P=!0);var w=!1;if("rectified_grid_angle"in this&&(w=!0),P&&(g=this.alpha),w&&(u=this.rectified_grid_angle*S),P||w)c=this.longc;else if(y=this.long1,m=this.lat1,p=this.long2,_=this.lat2,Math.abs(m-_)<=at||(t=Math.abs(m))<=at||Math.abs(t-f)<=at||Math.abs(Math.abs(this.lat0)-f)<=at||Math.abs(Math.abs(_)-f)<=at)throw new Error;var E=1-this.es;s=Math.sqrt(E),Math.abs(this.lat0)>d?(n=Math.sin(this.lat0),i=Math.cos(this.lat0),t=1-this.es*n*n,this.B=i*i,this.B=Math.sqrt(1+this.es*this.B*this.B/E),this.A=this.B*this.k0*s/t,h=this.B*s/(i*Math.sqrt(t)),a=h*h-1,a<=0?a=0:(a=Math.sqrt(a),this.lat0<0&&(a=-a)),this.E=a+=h,this.E*=Math.pow(T(this.e,this.lat0,n),this.B)):(this.B=1/s,this.A=this.k0,this.E=h=a=1),P||w?(P?(M=Math.asin(Math.sin(g)/h),w||(u=g)):(M=u,g=Math.asin(h*Math.sin(M))),this.lam0=c-Math.asin(.5*(a-1/a)*Math.tan(M))/this.B):(e=Math.pow(T(this.e,m,Math.sin(m)),this.B),r=Math.pow(T(this.e,_,Math.sin(_)),this.B),a=this.E/e,o=(r-e)/(r+e),l=this.E*this.E,l=(l-r*e)/(l+r*e),t=y-p,t<-Math.pi?p-=ot:t>Math.pi&&(p+=ot),this.lam0=x(.5*(y+p)-Math.atan(l*Math.tan(.5*this.B*(y-p))/o)/this.B),M=Math.atan(2*Math.sin(this.B*x(y-this.lam0))/(a-1/a)),u=g=Math.asin(h*Math.sin(M))),this.singam=Math.sin(M),this.cosgam=Math.cos(M),this.sinrot=Math.sin(u),this.cosrot=Math.cos(u),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A*this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(h*h-1)/Math.cos(g))),this.lat0<0&&(this.u_0=-this.u_0)),a=.5*M,this.v_pole_n=this.ArB*Math.log(Math.tan(b-a)),this.v_pole_s=this.ArB*Math.log(Math.tan(b+a))}function xa(t){var s={},i,h,a,e,r,n,o,l;if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-f)>d){if(r=this.E/Math.pow(T(this.e,t.y,Math.sin(t.y)),this.B),n=1/r,i=.5*(r-n),h=.5*(r+n),e=Math.sin(this.B*t.x),a=(i*this.singam-e*this.cosgam)/h,Math.abs(Math.abs(a)-1)<d)throw new Error;l=.5*this.ArB*Math.log((1-a)/(1+a)),n=Math.cos(this.B*t.x),Math.abs(n)<at?o=this.A*t.x:o=this.ArB*Math.atan2(i*this.cosgam+e*this.singam,n)}else l=t.y>0?this.v_pole_n:this.v_pole_s,o=this.ArB*t.y;return this.no_rot?(s.x=o,s.y=l):(o-=this.u_0,s.x=l*this.cosrot+o*this.sinrot,s.y=o*this.cosrot-l*this.sinrot),s.x=this.a*s.x+this.x0,s.y=this.a*s.y+this.y0,s}function _a(t){var s,i,h,a,e,r,n,o={};if(t.x=(t.x-this.x0)*(1/this.a),t.y=(t.y-this.y0)*(1/this.a),this.no_rot?(i=t.y,s=t.x):(i=t.x*this.cosrot-t.y*this.sinrot,s=t.y*this.cosrot+t.x*this.sinrot+this.u_0),h=Math.exp(-this.BrA*i),a=.5*(h-1/h),e=.5*(h+1/h),r=Math.sin(this.BrA*s),n=(r*this.cosgam+a*this.singam)/e,Math.abs(Math.abs(n)-1)<d)o.x=0,o.y=n<0?-f:f;else{if(o.y=this.E/Math.sqrt((1+n)/(1-n)),o.y=Mt(this.e,Math.pow(o.y,1/this.B)),o.y===1/0)throw new Error;o.x=-this.rB*Math.atan2(a*this.cosgam-r*this.singam,Math.cos(this.BrA*s))}return o.x+=this.lam0,o}var ga=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"],va={init:da,forward:xa,inverse:_a,names:ga};function ba(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<d)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var s=Math.sin(this.lat1),i=Math.cos(this.lat1),h=Q(this.e,s,i),a=T(this.e,this.lat1,s),e=Math.sin(this.lat2),r=Math.cos(this.lat2),n=Q(this.e,e,r),o=T(this.e,this.lat2,e),l=T(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>d?this.ns=Math.log(h/n)/Math.log(a/o):this.ns=s,isNaN(this.ns)&&(this.ns=s),this.f0=h/(this.ns*Math.pow(a,this.ns)),this.rh=this.a*this.f0*Math.pow(l,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function $a(t){var s=t.x,i=t.y;Math.abs(2*Math.abs(i)-Math.PI)<=d&&(i=lt(i)*(f-2*d));var h=Math.abs(Math.abs(i)-f),a,e;if(h>d)a=T(this.e,i,Math.sin(i)),e=this.a*this.f0*Math.pow(a,this.ns);else{if(h=i*this.ns,h<=0)return null;e=0}var r=this.ns*x(s-this.long0);return t.x=this.k0*(e*Math.sin(r))+this.x0,t.y=this.k0*(this.rh-e*Math.cos(r))+this.y0,t}function wa(t){var s,i,h,a,e,r=(t.x-this.x0)/this.k0,n=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(s=Math.sqrt(r*r+n*n),i=1):(s=-Math.sqrt(r*r+n*n),i=-1);var o=0;if(s!==0&&(o=Math.atan2(i*r,i*n)),s!==0||this.ns>0){if(i=1/this.ns,h=Math.pow(s/(this.a*this.f0),i),a=Mt(this.e,h),a===-9999)return null}else a=-f;return e=x(o/this.ns+this.long0),t.x=e,t.y=a,t}var Na=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"],Pa={init:ba,forward:$a,inverse:wa,names:Na};function Aa(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function Ea(t){var s,i,h,a,e,r,n,o=t.x,l=t.y,u=x(o-this.long0);return s=Math.pow((1+this.e*Math.sin(l))/(1-this.e*Math.sin(l)),this.alfa*this.e/2),i=2*(Math.atan(this.k*Math.pow(Math.tan(l/2+this.s45),this.alfa)/s)-this.s45),h=-u*this.alfa,a=Math.asin(Math.cos(this.ad)*Math.sin(i)+Math.sin(this.ad)*Math.cos(i)*Math.cos(h)),e=Math.asin(Math.cos(i)*Math.sin(h)/Math.cos(a)),r=this.n*e,n=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(a/2+this.s45),this.n),t.y=n*Math.cos(r)/1,t.x=n*Math.sin(r)/1,this.czech||(t.y*=-1,t.x*=-1),t}function qa(t){var s,i,h,a,e,r,n,o,l=t.x;t.x=t.y,t.y=l,this.czech||(t.y*=-1,t.x*=-1),r=Math.sqrt(t.x*t.x+t.y*t.y),e=Math.atan2(t.y,t.x),a=e/Math.sin(this.s0),h=2*(Math.atan(Math.pow(this.ro0/r,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),s=Math.asin(Math.cos(this.ad)*Math.sin(h)-Math.sin(this.ad)*Math.cos(h)*Math.cos(a)),i=Math.asin(Math.cos(h)*Math.sin(a)/Math.cos(s)),t.x=this.long0-i/this.alfa,n=s,o=0;var u=0;do t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(s/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(n))/(1-this.e*Math.sin(n)),this.e/2))-this.s45),Math.abs(n-t.y)<1e-10&&(o=1),n=t.y,u+=1;while(o===0&&u<15);return u>=15?null:t}var ka=["Krovak","krovak"],Sa={init:Aa,forward:Ea,inverse:qa,names:ka};function O(t,s,i,h,a){return t*a-s*Math.sin(2*a)+i*Math.sin(4*a)-h*Math.sin(6*a)}function ct(t){return 1-.25*t*(1+t/16*(3+1.25*t))}function ft(t){return .375*t*(1+.25*t*(1+.46875*t))}function yt(t){return .05859375*t*t*(1+.75*t)}function pt(t){return t*t*t*(35/3072)}function ht(t,s,i){var h=s*i;return t/Math.sqrt(1-h*h)}function W(t){return Math.abs(t)<f?t:t-lt(t)*Math.PI}function It(t,s,i,h,a){var e,r;e=t/s;for(var n=0;n<15;n++)if(r=(t-(s*e-i*Math.sin(2*e)+h*Math.sin(4*e)-a*Math.sin(6*e)))/(s-2*i*Math.cos(2*e)+4*h*Math.cos(4*e)-6*a*Math.cos(6*e)),e+=r,Math.abs(r)<=1e-10)return e;return NaN}function Ia(){this.sphere||(this.e0=ct(this.es),this.e1=ft(this.es),this.e2=yt(this.es),this.e3=pt(this.es),this.ml0=this.a*O(this.e0,this.e1,this.e2,this.e3,this.lat0))}function Ca(t){var s,i,h=t.x,a=t.y;if(h=x(h-this.long0),this.sphere)s=this.a*Math.asin(Math.cos(a)*Math.sin(h)),i=this.a*(Math.atan2(Math.tan(a),Math.cos(h))-this.lat0);else{var e=Math.sin(a),r=Math.cos(a),n=ht(this.a,this.e,e),o=Math.tan(a)*Math.tan(a),l=h*Math.cos(a),u=l*l,M=this.es*r*r/(1-this.es),c=this.a*O(this.e0,this.e1,this.e2,this.e3,a);s=n*l*(1-u*o*(1/6-(8-o+8*M)*u/120)),i=c-this.ml0+n*e/r*u*(.5+(5-o+6*M)*u/24)}return t.x=s+this.x0,t.y=i+this.y0,t}function Oa(t){t.x-=this.x0,t.y-=this.y0;var s=t.x/this.a,i=t.y/this.a,h,a;if(this.sphere){var e=i+this.lat0;h=Math.asin(Math.sin(e)*Math.cos(s)),a=Math.atan2(Math.tan(s),Math.cos(e))}else{var r=this.ml0/this.a+i,n=It(r,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(n)-f)<=d)return t.x=this.long0,t.y=f,i<0&&(t.y*=-1),t;var o=ht(this.a,this.e,Math.sin(n)),l=o*o*o/this.a/this.a*(1-this.es),u=Math.pow(Math.tan(n),2),M=s*this.a/o,c=M*M;h=n-o*Math.tan(n)/l*M*M*(.5-(1+3*u)*M*M/24),a=M*(1-c*(u/3+(1+3*u)*u*c/15))/Math.cos(n)}return t.x=x(a+this.long0),t.y=W(h),t}var Ba=["Cassini","Cassini_Soldner","cass"],ja={init:Ia,forward:Ca,inverse:Oa,names:Ba};function D(t,s){var i;return t>1e-7?(i=t*s,(1-t*t)*(s/(1-i*i)-.5/t*Math.log((1-i)/(1+i)))):2*s}var La=1,Ga=2,Ra=3,Ta=4;function za(){var t=Math.abs(this.lat0);if(Math.abs(t-f)<d?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(t)<d?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var s;switch(this.qp=D(this.e,1),this.mmf=.5/(1-this.es),this.apa=Ja(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),s=Math.sin(this.lat0),this.sinb1=D(this.e,s)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*s*s)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function Fa(t){var s,i,h,a,e,r,n,o,l,u,M=t.x,c=t.y;if(M=x(M-this.long0),this.sphere){if(e=Math.sin(c),u=Math.cos(c),h=Math.cos(M),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(i=this.mode===this.EQUIT?1+u*h:1+this.sinph0*e+this.cosph0*u*h,i<=d)return null;i=Math.sqrt(2/i),s=i*u*Math.sin(M),i*=this.mode===this.EQUIT?e:this.cosph0*e-this.sinph0*u*h}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(h=-h),Math.abs(c+this.lat0)<d)return null;i=b-c*.5,i=2*(this.mode===this.S_POLE?Math.cos(i):Math.sin(i)),s=i*Math.sin(M),i*=h}}else{switch(n=0,o=0,l=0,h=Math.cos(M),a=Math.sin(M),e=Math.sin(c),r=D(this.e,e),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(n=r/this.qp,o=Math.sqrt(1-n*n)),this.mode){case this.OBLIQ:l=1+this.sinb1*n+this.cosb1*o*h;break;case this.EQUIT:l=1+o*h;break;case this.N_POLE:l=f+c,r=this.qp-r;break;case this.S_POLE:l=c-f,r=this.qp+r;break}if(Math.abs(l)<d)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:l=Math.sqrt(2/l),this.mode===this.OBLIQ?i=this.ymf*l*(this.cosb1*n-this.sinb1*o*h):i=(l=Math.sqrt(2/(1+o*h)))*n*this.ymf,s=this.xmf*l*o*a;break;case this.N_POLE:case this.S_POLE:r>=0?(s=(l=Math.sqrt(r))*a,i=h*(this.mode===this.S_POLE?l:-l)):s=i=0;break}}return t.x=this.a*s+this.x0,t.y=this.a*i+this.y0,t}function Qa(t){t.x-=this.x0,t.y-=this.y0;var s=t.x/this.a,i=t.y/this.a,h,a,e,r,n,o,l;if(this.sphere){var u=0,M,c=0;if(M=Math.sqrt(s*s+i*i),a=M*.5,a>1)return null;switch(a=2*Math.asin(a),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(c=Math.sin(a),u=Math.cos(a)),this.mode){case this.EQUIT:a=Math.abs(M)<=d?0:Math.asin(i*c/M),s*=c,i=u*M;break;case this.OBLIQ:a=Math.abs(M)<=d?this.lat0:Math.asin(u*this.sinph0+i*c*this.cosph0/M),s*=c*this.cosph0,i=(u-Math.sin(a)*this.sinph0)*M;break;case this.N_POLE:i=-i,a=f-a;break;case this.S_POLE:a-=f;break}h=i===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(s,i)}else{if(l=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(s/=this.dd,i*=this.dd,o=Math.sqrt(s*s+i*i),o<d)return t.x=this.long0,t.y=this.lat0,t;r=2*Math.asin(.5*o/this.rq),e=Math.cos(r),s*=r=Math.sin(r),this.mode===this.OBLIQ?(l=e*this.sinb1+i*r*this.cosb1/o,n=this.qp*l,i=o*this.cosb1*e-i*this.sinb1*r):(l=i*r/o,n=this.qp*l,i=o*e)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),n=s*s+i*i,!n)return t.x=this.long0,t.y=this.lat0,t;l=1-n/this.qp,this.mode===this.S_POLE&&(l=-l)}h=Math.atan2(s,i),a=Va(Math.asin(l),this.apa)}return t.x=x(this.long0+h),t.y=a,t}var Ua=.3333333333333333,Wa=.17222222222222222,Da=.10257936507936508,Ha=.06388888888888888,Ka=.0664021164021164,Xa=.016415012942191543;function Ja(t){var s,i=[];return i[0]=t*Ua,s=t*t,i[0]+=s*Wa,i[1]=s*Ha,s*=t,i[0]+=s*Da,i[1]+=s*Ka,i[2]=s*Xa,i}function Va(t,s){var i=t+t;return t+s[0]*Math.sin(i)+s[1]*Math.sin(i+i)+s[2]*Math.sin(i+i+i)}var Za=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],Ya={init:za,forward:Fa,inverse:Qa,names:Za,S_POLE:La,N_POLE:Ga,EQUIT:Ra,OBLIQ:Ta};function H(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}function th(){Math.abs(this.lat1+this.lat2)<d||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Q(this.e3,this.sin_po,this.cos_po),this.qs1=D(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Q(this.e3,this.sin_po,this.cos_po),this.qs2=D(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=D(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>d?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function sh(t){var s=t.x,i=t.y;this.sin_phi=Math.sin(i),this.cos_phi=Math.cos(i);var h=D(this.e3,this.sin_phi),a=this.a*Math.sqrt(this.c-this.ns0*h)/this.ns0,e=this.ns0*x(s-this.long0),r=a*Math.sin(e)+this.x0,n=this.rh-a*Math.cos(e)+this.y0;return t.x=r,t.y=n,t}function ih(t){var s,i,h,a,e,r;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(s=Math.sqrt(t.x*t.x+t.y*t.y),h=1):(s=-Math.sqrt(t.x*t.x+t.y*t.y),h=-1),a=0,s!==0&&(a=Math.atan2(h*t.x,h*t.y)),h=s*this.ns0/this.a,this.sphere?r=Math.asin((this.c-h*h)/(2*this.ns0)):(i=(this.c-h*h)/this.ns0,r=this.phi1z(this.e3,i)),e=x(a/this.ns0+this.long0),t.x=e,t.y=r,t}function ah(t,s){var i,h,a,e,r,n=H(.5*s);if(t<d)return n;for(var o=t*t,l=1;l<=25;l++)if(i=Math.sin(n),h=Math.cos(n),a=t*i,e=1-a*a,r=.5*e*e/h*(s/(1-o)-i/e+.5/t*Math.log((1-a)/(1+a))),n=n+r,Math.abs(r)<=1e-7)return n;return null}var hh=["Albers_Conic_Equal_Area","Albers","aea"],eh={init:th,forward:sh,inverse:ih,names:hh,phi1z:ah};function nh(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function rh(t){var s,i,h,a,e,r,n,o,l=t.x,u=t.y;return h=x(l-this.long0),s=Math.sin(u),i=Math.cos(u),a=Math.cos(h),r=this.sin_p14*s+this.cos_p14*i*a,e=1,r>0||Math.abs(r)<=d?(n=this.x0+this.a*e*i*Math.sin(h)/r,o=this.y0+this.a*e*(this.cos_p14*s-this.sin_p14*i*a)/r):(n=this.x0+this.infinity_dist*i*Math.sin(h),o=this.y0+this.infinity_dist*(this.cos_p14*s-this.sin_p14*i*a)),t.x=n,t.y=o,t}function oh(t){var s,i,h,a,e,r;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(s=Math.sqrt(t.x*t.x+t.y*t.y))?(a=Math.atan2(s,this.rc),i=Math.sin(a),h=Math.cos(a),r=H(h*this.sin_p14+t.y*i*this.cos_p14/s),e=Math.atan2(t.x*i,s*this.cos_p14*h-t.y*this.sin_p14*i),e=x(this.long0+e)):(r=this.phic0,e=0),t.x=e,t.y=r,t}var lh=["gnom"],Mh={init:nh,forward:rh,inverse:oh,names:lh};function uh(t,s){var i=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(s)-i)<1e-6)return s<0?-1*f:f;for(var h=Math.asin(.5*s),a,e,r,n,o=0;o<30;o++)if(e=Math.sin(h),r=Math.cos(h),n=t*e,a=Math.pow(1-n*n,2)/(2*r)*(s/(1-t*t)-e/(1-n*n)+.5/t*Math.log((1-n)/(1+n))),h+=a,Math.abs(a)<=1e-10)return h;return NaN}function ch(){this.sphere||(this.k0=Q(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function fh(t){var s=t.x,i=t.y,h,a,e=x(s-this.long0);if(this.sphere)h=this.x0+this.a*e*Math.cos(this.lat_ts),a=this.y0+this.a*Math.sin(i)/Math.cos(this.lat_ts);else{var r=D(this.e,Math.sin(i));h=this.x0+this.a*this.k0*e,a=this.y0+this.a*r*.5/this.k0}return t.x=h,t.y=a,t}function yh(t){t.x-=this.x0,t.y-=this.y0;var s,i;return this.sphere?(s=x(this.long0+t.x/this.a/Math.cos(this.lat_ts)),i=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(i=uh(this.e,2*t.y*this.k0/this.a),s=x(this.long0+t.x/(this.a*this.k0))),t.x=s,t.y=i,t}var ph=["cea"],mh={init:ch,forward:fh,inverse:yh,names:ph};function dh(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function xh(t){var s=t.x,i=t.y,h=x(s-this.long0),a=W(i-this.lat0);return t.x=this.x0+this.a*h*this.rc,t.y=this.y0+this.a*a,t}function _h(t){var s=t.x,i=t.y;return t.x=x(this.long0+(s-this.x0)/(this.a*this.rc)),t.y=W(this.lat0+(i-this.y0)/this.a),t}var gh=["Equirectangular","Equidistant_Cylindrical","eqc"],vh={init:dh,forward:xh,inverse:_h,names:gh},ps=20;function bh(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=ct(this.es),this.e1=ft(this.es),this.e2=yt(this.es),this.e3=pt(this.es),this.ml0=this.a*O(this.e0,this.e1,this.e2,this.e3,this.lat0)}function $h(t){var s=t.x,i=t.y,h,a,e,r=x(s-this.long0);if(e=r*Math.sin(i),this.sphere)Math.abs(i)<=d?(h=this.a*r,a=-1*this.a*this.lat0):(h=this.a*Math.sin(e)/Math.tan(i),a=this.a*(W(i-this.lat0)+(1-Math.cos(e))/Math.tan(i)));else if(Math.abs(i)<=d)h=this.a*r,a=-1*this.ml0;else{var n=ht(this.a,this.e,Math.sin(i))/Math.tan(i);h=n*Math.sin(e),a=this.a*O(this.e0,this.e1,this.e2,this.e3,i)-this.ml0+n*(1-Math.cos(e))}return t.x=h+this.x0,t.y=a+this.y0,t}function wh(t){var s,i,h,a,e,r,n,o,l;if(h=t.x-this.x0,a=t.y-this.y0,this.sphere)if(Math.abs(a+this.a*this.lat0)<=d)s=x(h/this.a+this.long0),i=0;else{r=this.lat0+a/this.a,n=h*h/this.a/this.a+r*r,o=r;var u;for(e=ps;e;--e)if(u=Math.tan(o),l=-1*(r*(o*u+1)-o-.5*(o*o+n)*u)/((o-r)/u-1),o+=l,Math.abs(l)<=d){i=o;break}s=x(this.long0+Math.asin(h*Math.tan(o)/this.a)/Math.sin(i))}else if(Math.abs(a+this.ml0)<=d)i=0,s=x(this.long0+h/this.a);else{r=(this.ml0+a)/this.a,n=h*h/this.a/this.a+r*r,o=r;var M,c,y,p,m;for(e=ps;e;--e)if(m=this.e*Math.sin(o),M=Math.sqrt(1-m*m)*Math.tan(o),c=this.a*O(this.e0,this.e1,this.e2,this.e3,o),y=this.e0-2*this.e1*Math.cos(2*o)+4*this.e2*Math.cos(4*o)-6*this.e3*Math.cos(6*o),p=c/this.a,l=(r*(M*p+1)-p-.5*M*(p*p+n))/(this.es*Math.sin(2*o)*(p*p+n-2*r*p)/(4*M)+(r-p)*(M*y-2/Math.sin(2*o))-y),o-=l,Math.abs(l)<=d){i=o;break}M=Math.sqrt(1-this.es*Math.pow(Math.sin(i),2))*Math.tan(i),s=x(this.long0+Math.asin(h*M/this.a)/Math.sin(i))}return t.x=s,t.y=i,t}var Nh=["Polyconic","poly"],Ph={init:bh,forward:$h,inverse:wh,names:Nh};function Ah(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function Eh(t){var s,i=t.x,h=t.y,a=h-this.lat0,e=i-this.long0,r=a/rt*1e-5,n=e,o=1,l=0;for(s=1;s<=10;s++)o=o*r,l=l+this.A[s]*o;var u=l,M=n,c=1,y=0,p,m,_=0,g=0;for(s=1;s<=6;s++)p=c*u-y*M,m=y*u+c*M,c=p,y=m,_=_+this.B_re[s]*c-this.B_im[s]*y,g=g+this.B_im[s]*c+this.B_re[s]*y;return t.x=g*this.a+this.x0,t.y=_*this.a+this.y0,t}function qh(t){var s,i=t.x,h=t.y,a=i-this.x0,e=h-this.y0,r=e/this.a,n=a/this.a,o=1,l=0,u,M,c=0,y=0;for(s=1;s<=6;s++)u=o*r-l*n,M=l*r+o*n,o=u,l=M,c=c+this.C_re[s]*o-this.C_im[s]*l,y=y+this.C_im[s]*o+this.C_re[s]*l;for(var p=0;p<this.iterations;p++){var m=c,_=y,g,P,w=r,E=n;for(s=2;s<=6;s++)g=m*c-_*y,P=_*c+m*y,m=g,_=P,w=w+(s-1)*(this.B_re[s]*m-this.B_im[s]*_),E=E+(s-1)*(this.B_im[s]*m+this.B_re[s]*_);m=1,_=0;var N=this.B_re[1],A=this.B_im[1];for(s=2;s<=6;s++)g=m*c-_*y,P=_*c+m*y,m=g,_=P,N=N+s*(this.B_re[s]*m-this.B_im[s]*_),A=A+s*(this.B_im[s]*m+this.B_re[s]*_);var G=N*N+A*A;c=(w*N+E*A)/G,y=(E*N-w*A)/G}var k=c,z=y,K=1,X=0;for(s=1;s<=9;s++)K=K*k,X=X+this.D[s]*K;var $t=this.lat0+X*rt*1e5,_s=this.long0+z;return t.x=_s,t.y=$t,t}var kh=["New_Zealand_Map_Grid","nzmg"],Sh={init:Ah,forward:Eh,inverse:qh,names:kh};function Ih(){}function Ch(t){var s=t.x,i=t.y,h=x(s-this.long0),a=this.x0+this.a*h,e=this.y0+this.a*Math.log(Math.tan(Math.PI/4+i/2.5))*1.25;return t.x=a,t.y=e,t}function Oh(t){t.x-=this.x0,t.y-=this.y0;var s=x(this.long0+t.x/this.a),i=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=s,t.y=i,t}var Bh=["Miller_Cylindrical","mill"],jh={init:Ih,forward:Ch,inverse:Oh,names:Bh},Lh=20;function Gh(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Tt(this.es)}function Rh(t){var s,i,h=t.x,a=t.y;if(h=x(h-this.long0),this.sphere){if(!this.m)a=this.n!==1?Math.asin(this.n*Math.sin(a)):a;else for(var e=this.n*Math.sin(a),r=Lh;r;--r){var n=(this.m*a+Math.sin(a)-e)/(this.m+Math.cos(a));if(a-=n,Math.abs(n)<d)break}s=this.a*this.C_x*h*(this.m+Math.cos(a)),i=this.a*this.C_y*a}else{var o=Math.sin(a),l=Math.cos(a);i=this.a*it(a,o,l,this.en),s=this.a*h*l/Math.sqrt(1-this.es*o*o)}return t.x=s,t.y=i,t}function Th(t){var s,i,h,a;return t.x-=this.x0,h=t.x/this.a,t.y-=this.y0,s=t.y/this.a,this.sphere?(s/=this.C_y,h=h/(this.C_x*(this.m+Math.cos(s))),this.m?s=H((this.m*s+Math.sin(s))/this.n):this.n!==1&&(s=H(Math.sin(s)/this.n)),h=x(h+this.long0),s=W(s)):(s=zt(t.y/this.a,this.es,this.en),a=Math.abs(s),a<f?(a=Math.sin(s),i=this.long0+t.x*Math.sqrt(1-this.es*a*a)/(this.a*Math.cos(s)),h=x(i)):a-d<f&&(h=this.long0)),t.x=h,t.y=s,t}var zh=["Sinusoidal","sinu"],Fh={init:Gh,forward:Rh,inverse:Th,names:zh};function Qh(){}function Uh(t){for(var s=t.x,i=t.y,h=x(s-this.long0),a=i,e=Math.PI*Math.sin(i);;){var r=-(a+Math.sin(a)-e)/(1+Math.cos(a));if(a+=r,Math.abs(r)<d)break}a/=2,Math.PI/2-Math.abs(i)<d&&(h=0);var n=.900316316158*this.a*h*Math.cos(a)+this.x0,o=1.4142135623731*this.a*Math.sin(a)+this.y0;return t.x=n,t.y=o,t}function Wh(t){var s,i;t.x-=this.x0,t.y-=this.y0,i=t.y/(1.4142135623731*this.a),Math.abs(i)>.999999999999&&(i=.999999999999),s=Math.asin(i);var h=x(this.long0+t.x/(.900316316158*this.a*Math.cos(s)));h<-Math.PI&&(h=-Math.PI),h>Math.PI&&(h=Math.PI),i=(2*s+Math.sin(2*s))/Math.PI,Math.abs(i)>1&&(i=1);var a=Math.asin(i);return t.x=h,t.y=a,t}var Dh=["Mollweide","moll"],Hh={init:Qh,forward:Uh,inverse:Wh,names:Dh};function Kh(){Math.abs(this.lat1+this.lat2)<d||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=ct(this.es),this.e1=ft(this.es),this.e2=yt(this.es),this.e3=pt(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Q(this.e,this.sinphi,this.cosphi),this.ml1=O(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<d?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Q(this.e,this.sinphi,this.cosphi),this.ml2=O(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=O(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function Xh(t){var s=t.x,i=t.y,h;if(this.sphere)h=this.a*(this.g-i);else{var a=O(this.e0,this.e1,this.e2,this.e3,i);h=this.a*(this.g-a)}var e=this.ns*x(s-this.long0),r=this.x0+h*Math.sin(e),n=this.y0+this.rh-h*Math.cos(e);return t.x=r,t.y=n,t}function Jh(t){t.x-=this.x0,t.y=this.rh-t.y+this.y0;var s,i,h,a;this.ns>=0?(i=Math.sqrt(t.x*t.x+t.y*t.y),s=1):(i=-Math.sqrt(t.x*t.x+t.y*t.y),s=-1);var e=0;if(i!==0&&(e=Math.atan2(s*t.x,s*t.y)),this.sphere)return a=x(this.long0+e/this.ns),h=W(this.g-i/this.a),t.x=a,t.y=h,t;var r=this.g-i/this.a;return h=It(r,this.e0,this.e1,this.e2,this.e3),a=x(this.long0+e/this.ns),t.x=a,t.y=h,t}var Vh=["Equidistant_Conic","eqdc"],Zh={init:Kh,forward:Xh,inverse:Jh,names:Vh};function Yh(){this.R=this.a}function te(t){var s=t.x,i=t.y,h=x(s-this.long0),a,e;Math.abs(i)<=d&&(a=this.x0+this.R*h,e=this.y0);var r=H(2*Math.abs(i/Math.PI));(Math.abs(h)<=d||Math.abs(Math.abs(i)-f)<=d)&&(a=this.x0,i>=0?e=this.y0+Math.PI*this.R*Math.tan(.5*r):e=this.y0+Math.PI*this.R*-Math.tan(.5*r));var n=.5*Math.abs(Math.PI/h-h/Math.PI),o=n*n,l=Math.sin(r),u=Math.cos(r),M=u/(l+u-1),c=M*M,y=M*(2/l-1),p=y*y,m=Math.PI*this.R*(n*(M-p)+Math.sqrt(o*(M-p)*(M-p)-(p+o)*(c-p)))/(p+o);h<0&&(m=-m),a=this.x0+m;var _=o+M;return m=Math.PI*this.R*(y*_-n*Math.sqrt((p+o)*(o+1)-_*_))/(p+o),i>=0?e=this.y0+m:e=this.y0-m,t.x=a,t.y=e,t}function se(t){var s,i,h,a,e,r,n,o,l,u,M,c,y;return t.x-=this.x0,t.y-=this.y0,M=Math.PI*this.R,h=t.x/M,a=t.y/M,e=h*h+a*a,r=-Math.abs(a)*(1+e),n=r-2*a*a+h*h,o=-2*r+1+2*a*a+e*e,y=a*a/o+(2*n*n*n/o/o/o-9*r*n/o/o)/27,l=(r-n*n/3/o)/o,u=2*Math.sqrt(-l/3),M=3*y/l/u,Math.abs(M)>1&&(M>=0?M=1:M=-1),c=Math.acos(M)/3,t.y>=0?i=(-u*Math.cos(c+Math.PI/3)-n/3/o)*Math.PI:i=-(-u*Math.cos(c+Math.PI/3)-n/3/o)*Math.PI,Math.abs(h)<d?s=this.long0:s=x(this.long0+Math.PI*(e-1+Math.sqrt(1+2*(h*h-a*a)+e*e))/2/h),t.x=s,t.y=i,t}var ie=["Van_der_Grinten_I","VanDerGrinten","vandg"],ae={init:Yh,forward:te,inverse:se,names:ie};function he(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function ee(t){var s=t.x,i=t.y,h=Math.sin(t.y),a=Math.cos(t.y),e=x(s-this.long0),r,n,o,l,u,M,c,y,p,m,_,g,P,w,E,N,A,G,k,z,K,X,$t;return this.sphere?Math.abs(this.sin_p12-1)<=d?(t.x=this.x0+this.a*(f-i)*Math.sin(e),t.y=this.y0-this.a*(f-i)*Math.cos(e),t):Math.abs(this.sin_p12+1)<=d?(t.x=this.x0+this.a*(f+i)*Math.sin(e),t.y=this.y0+this.a*(f+i)*Math.cos(e),t):(G=this.sin_p12*h+this.cos_p12*a*Math.cos(e),N=Math.acos(G),A=N?N/Math.sin(N):1,t.x=this.x0+this.a*A*a*Math.sin(e),t.y=this.y0+this.a*A*(this.cos_p12*h-this.sin_p12*a*Math.cos(e)),t):(r=ct(this.es),n=ft(this.es),o=yt(this.es),l=pt(this.es),Math.abs(this.sin_p12-1)<=d?(u=this.a*O(r,n,o,l,f),M=this.a*O(r,n,o,l,i),t.x=this.x0+(u-M)*Math.sin(e),t.y=this.y0-(u-M)*Math.cos(e),t):Math.abs(this.sin_p12+1)<=d?(u=this.a*O(r,n,o,l,f),M=this.a*O(r,n,o,l,i),t.x=this.x0+(u+M)*Math.sin(e),t.y=this.y0+(u+M)*Math.cos(e),t):(c=h/a,y=ht(this.a,this.e,this.sin_p12),p=ht(this.a,this.e,h),m=Math.atan((1-this.es)*c+this.es*y*this.sin_p12/(p*a)),_=Math.atan2(Math.sin(e),this.cos_p12*Math.tan(m)-this.sin_p12*Math.cos(e)),_===0?k=Math.asin(this.cos_p12*Math.sin(m)-this.sin_p12*Math.cos(m)):Math.abs(Math.abs(_)-Math.PI)<=d?k=-Math.asin(this.cos_p12*Math.sin(m)-this.sin_p12*Math.cos(m)):k=Math.asin(Math.sin(e)*Math.cos(m)/Math.sin(_)),g=this.e*this.sin_p12/Math.sqrt(1-this.es),P=this.e*this.cos_p12*Math.cos(_)/Math.sqrt(1-this.es),w=g*P,E=P*P,z=k*k,K=z*k,X=K*k,$t=X*k,N=y*k*(1-z*E*(1-E)/6+K/8*w*(1-2*E)+X/120*(E*(4-7*E)-3*g*g*(1-7*E))-$t/48*w),t.x=this.x0+N*Math.sin(_),t.y=this.y0+N*Math.cos(_),t))}function ne(t){t.x-=this.x0,t.y-=this.y0;var s,i,h,a,e,r,n,o,l,u,M,c,y,p,m,_,g,P,w,E,N,A,G,k;return this.sphere?(s=Math.sqrt(t.x*t.x+t.y*t.y),s>2*f*this.a?void 0:(i=s/this.a,h=Math.sin(i),a=Math.cos(i),e=this.long0,Math.abs(s)<=d?r=this.lat0:(r=H(a*this.sin_p12+t.y*h*this.cos_p12/s),n=Math.abs(this.lat0)-f,Math.abs(n)<=d?this.lat0>=0?e=x(this.long0+Math.atan2(t.x,-t.y)):e=x(this.long0-Math.atan2(-t.x,t.y)):e=x(this.long0+Math.atan2(t.x*h,s*this.cos_p12*a-t.y*this.sin_p12*h))),t.x=e,t.y=r,t)):(o=ct(this.es),l=ft(this.es),u=yt(this.es),M=pt(this.es),Math.abs(this.sin_p12-1)<=d?(c=this.a*O(o,l,u,M,f),s=Math.sqrt(t.x*t.x+t.y*t.y),y=c-s,r=It(y/this.a,o,l,u,M),e=x(this.long0+Math.atan2(t.x,-1*t.y)),t.x=e,t.y=r,t):Math.abs(this.sin_p12+1)<=d?(c=this.a*O(o,l,u,M,f),s=Math.sqrt(t.x*t.x+t.y*t.y),y=s-c,r=It(y/this.a,o,l,u,M),e=x(this.long0+Math.atan2(t.x,t.y)),t.x=e,t.y=r,t):(s=Math.sqrt(t.x*t.x+t.y*t.y),_=Math.atan2(t.x,t.y),p=ht(this.a,this.e,this.sin_p12),g=Math.cos(_),P=this.e*this.cos_p12*g,w=-P*P/(1-this.es),E=3*this.es*(1-w)*this.sin_p12*this.cos_p12*g/(1-this.es),N=s/p,A=N-w*(1+w)*Math.pow(N,3)/6-E*(1+3*w)*Math.pow(N,4)/24,G=1-w*A*A/2-N*A*A*A/6,m=Math.asin(this.sin_p12*Math.cos(A)+this.cos_p12*Math.sin(A)*g),e=x(this.long0+Math.asin(Math.sin(_)*Math.sin(A)/Math.cos(m))),k=Math.sin(m),r=Math.atan2((k-this.es*G*this.sin_p12)*Math.tan(m),k*(1-this.es)),t.x=e,t.y=r,t))}var re=["Azimuthal_Equidistant","aeqd"],oe={init:he,forward:ee,inverse:ne,names:re};function le(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function Me(t){var s,i,h,a,e,r,n,o,l=t.x,u=t.y;return h=x(l-this.long0),s=Math.sin(u),i=Math.cos(u),a=Math.cos(h),r=this.sin_p14*s+this.cos_p14*i*a,e=1,(r>0||Math.abs(r)<=d)&&(n=this.a*e*i*Math.sin(h),o=this.y0+this.a*e*(this.cos_p14*s-this.sin_p14*i*a)),t.x=n,t.y=o,t}function ue(t){var s,i,h,a,e,r,n;return t.x-=this.x0,t.y-=this.y0,s=Math.sqrt(t.x*t.x+t.y*t.y),i=H(s/this.a),h=Math.sin(i),a=Math.cos(i),r=this.long0,Math.abs(s)<=d?(n=this.lat0,t.x=r,t.y=n,t):(n=H(a*this.sin_p14+t.y*h*this.cos_p14/s),e=Math.abs(this.lat0)-f,Math.abs(e)<=d?(this.lat0>=0?r=x(this.long0+Math.atan2(t.x,-t.y)):r=x(this.long0-Math.atan2(-t.x,t.y)),t.x=r,t.y=n,t):(r=x(this.long0+Math.atan2(t.x*h,s*this.cos_p14*a-t.y*this.sin_p14*h)),t.x=r,t.y=n,t))}var ce=["ortho"],fe={init:le,forward:Me,inverse:ue,names:ce},q={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},$={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function ye(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=f-b/2?this.face=q.TOP:this.lat0<=-(f-b/2)?this.face=q.BOTTOM:Math.abs(this.long0)<=b?this.face=q.FRONT:Math.abs(this.long0)<=f+b?this.face=this.long0>0?q.RIGHT:q.LEFT:this.face=q.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function pe(t){var s={x:0,y:0},i,h,a,e,r,n,o={value:0};if(t.x-=this.long0,this.es!==0?i=Math.atan(this.one_minus_f_squared*Math.tan(t.y)):i=t.y,h=t.x,this.face===q.TOP)e=f-i,h>=b&&h<=f+b?(o.value=$.AREA_0,a=h-f):h>f+b||h<=-(f+b)?(o.value=$.AREA_1,a=h>0?h-I:h+I):h>-(f+b)&&h<=-b?(o.value=$.AREA_2,a=h+f):(o.value=$.AREA_3,a=h);else if(this.face===q.BOTTOM)e=f+i,h>=b&&h<=f+b?(o.value=$.AREA_0,a=-h+f):h<b&&h>=-b?(o.value=$.AREA_1,a=-h):h<-b&&h>=-(f+b)?(o.value=$.AREA_2,a=-h-f):(o.value=$.AREA_3,a=h>0?-h+I:-h-I);else{var l,u,M,c,y,p,m;this.face===q.RIGHT?h=et(h,+f):this.face===q.BACK?h=et(h,3.14159265359):this.face===q.LEFT&&(h=et(h,-f)),c=Math.sin(i),y=Math.cos(i),p=Math.sin(h),m=Math.cos(h),l=y*m,u=y*p,M=c,this.face===q.FRONT?(e=Math.acos(l),a=Ct(e,M,u,o)):this.face===q.RIGHT?(e=Math.acos(u),a=Ct(e,M,-l,o)):this.face===q.BACK?(e=Math.acos(-l),a=Ct(e,M,-u,o)):this.face===q.LEFT?(e=Math.acos(-u),a=Ct(e,M,l,o)):(e=a=0,o.value=$.AREA_0)}return n=Math.atan(12/I*(a+Math.acos(Math.sin(a)*Math.cos(b))-f)),r=Math.sqrt((1-Math.cos(e))/(Math.cos(n)*Math.cos(n))/(1-Math.cos(Math.atan(1/Math.cos(a))))),o.value===$.AREA_1?n+=f:o.value===$.AREA_2?n+=I:o.value===$.AREA_3&&(n+=1.5*I),s.x=r*Math.cos(n),s.y=r*Math.sin(n),s.x=s.x*this.a+this.x0,s.y=s.y*this.a+this.y0,t.x=s.x,t.y=s.y,t}function me(t){var s={lam:0,phi:0},i,h,a,e,r,n,o,l,u,M={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,h=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),i=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?M.value=$.AREA_0:t.y>=0&&t.y>=Math.abs(t.x)?(M.value=$.AREA_1,i-=f):t.x<0&&-t.x>=Math.abs(t.y)?(M.value=$.AREA_2,i=i<0?i+I:i-I):(M.value=$.AREA_3,i+=f),u=I/12*Math.tan(i),r=Math.sin(u)/(Math.cos(u)-1/Math.sqrt(2)),n=Math.atan(r),a=Math.cos(i),e=Math.tan(h),o=1-a*a*e*e*(1-Math.cos(Math.atan(1/Math.cos(n)))),o<-1?o=-1:o>1&&(o=1),this.face===q.TOP)l=Math.acos(o),s.phi=f-l,M.value===$.AREA_0?s.lam=n+f:M.value===$.AREA_1?s.lam=n<0?n+I:n-I:M.value===$.AREA_2?s.lam=n-f:s.lam=n;else if(this.face===q.BOTTOM)l=Math.acos(o),s.phi=l-f,M.value===$.AREA_0?s.lam=-n+f:M.value===$.AREA_1?s.lam=-n:M.value===$.AREA_2?s.lam=-n-f:s.lam=n<0?-n-I:-n+I;else{var c,y,p;c=o,u=c*c,u>=1?p=0:p=Math.sqrt(1-u)*Math.sin(n),u+=p*p,u>=1?y=0:y=Math.sqrt(1-u),M.value===$.AREA_1?(u=y,y=-p,p=u):M.value===$.AREA_2?(y=-y,p=-p):M.value===$.AREA_3&&(u=y,y=p,p=-u),this.face===q.RIGHT?(u=c,c=-y,y=u):this.face===q.BACK?(c=-c,y=-y):this.face===q.LEFT&&(u=c,c=y,y=-u),s.phi=Math.acos(-p)-f,s.lam=Math.atan2(y,c),this.face===q.RIGHT?s.lam=et(s.lam,-f):this.face===q.BACK?s.lam=et(s.lam,-3.14159265359):this.face===q.LEFT&&(s.lam=et(s.lam,+f))}if(this.es!==0){var m,_,g;m=s.phi<0?1:0,_=Math.tan(s.phi),g=this.b/Math.sqrt(_*_+this.one_minus_f_squared),s.phi=Math.atan(Math.sqrt(this.a*this.a-g*g)/(this.one_minus_f*g)),m&&(s.phi=-s.phi)}return s.lam+=this.long0,t.x=s.lam,t.y=s.phi,t}function Ct(t,s,i,h){var a;return t<d?(h.value=$.AREA_0,a=0):(a=Math.atan2(s,i),Math.abs(a)<=b?h.value=$.AREA_0:a>b&&a<=f+b?(h.value=$.AREA_1,a-=f):a>f+b||a<=-(f+b)?(h.value=$.AREA_2,a=a>=0?a-I:a+I):(h.value=$.AREA_3,a+=f)),a}function et(t,s){var i=t+s;return i<-3.14159265359?i+=ot:i>3.14159265359&&(i-=ot),i}var de=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"],xe={init:ye,forward:pe,inverse:me,names:de},Wt=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],mt=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],ms=.8487,ds=1.3523,xs=F/5,_e=1/xs,nt=18,Ot=function(t,s){return t[0]+s*(t[1]+s*(t[2]+s*t[3]))},ge=function(t,s){return t[1]+s*(2*t[2]+s*3*t[3])};function ve(t,s,i,h){for(var a=s;h;--h){var e=t(a);if(a-=e,Math.abs(e)<i)break}return a}function be(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function $e(t){var s=x(t.x-this.long0),i=Math.abs(t.y),h=Math.floor(i*xs);h<0?h=0:h>=nt&&(h=nt-1),i=F*(i-_e*h);var a={x:Ot(Wt[h],i)*s,y:Ot(mt[h],i)};return t.y<0&&(a.y=-a.y),a.x=a.x*this.a*ms+this.x0,a.y=a.y*this.a*ds+this.y0,a}function we(t){var s={x:(t.x-this.x0)/(this.a*ms),y:Math.abs(t.y-this.y0)/(this.a*ds)};if(s.y>=1)s.x/=Wt[nt][0],s.y=t.y<0?-f:f;else{var i=Math.floor(s.y*nt);for(i<0?i=0:i>=nt&&(i=nt-1);;)if(mt[i][0]>s.y)--i;else if(mt[i+1][0]<=s.y)++i;else break;var h=mt[i],a=5*(s.y-h[0])/(mt[i+1][0]-h[0]);a=ve(function(e){return(Ot(h,e)-s.y)/ge(h,e)},a,d,100),s.x/=Ot(Wt[i],a),s.y=(5*i+a)*S,t.y<0&&(s.y=-s.y)}return s.x=x(s.x+this.long0),s}var Ne=["Robinson","robin"],Pe={init:be,forward:$e,inverse:we,names:Ne};function Ae(){this.name="geocent"}function Ee(t){var s=ss(t,this.es,this.a);return s}function qe(t){var s=is(t,this.es,this.a,this.b);return s}var ke=["Geocentric","geocentric","geocent","Geocent"],Se={init:Ae,forward:Ee,inverse:qe,names:ke},C={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},dt={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function Ie(){if(Object.keys(dt).forEach((function(i){if(typeof this[i]>"u")this[i]=dt[i].def;else{if(dt[i].num&&isNaN(this[i]))throw new Error("Invalid parameter value, must be numeric "+i+" = "+this[i]);dt[i].num&&(this[i]=parseFloat(this[i]))}dt[i].degrees&&(this[i]=this[i]*S)}).bind(this)),Math.abs(Math.abs(this.lat0)-f)<d?this.mode=this.lat0<0?C.S_POLE:C.N_POLE:Math.abs(this.lat0)<d?this.mode=C.EQUIT:(this.mode=C.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,s=this.azi;this.cg=Math.cos(s),this.sg=Math.sin(s),this.cw=Math.cos(t),this.sw=Math.sin(t)}function Ce(t){t.x-=this.long0;var s=Math.sin(t.y),i=Math.cos(t.y),h=Math.cos(t.x),a,e;switch(this.mode){case C.OBLIQ:e=this.sinph0*s+this.cosph0*i*h;break;case C.EQUIT:e=i*h;break;case C.S_POLE:e=-s;break;case C.N_POLE:e=s;break}switch(e=this.pn1/(this.p-e),a=e*i*Math.sin(t.x),this.mode){case C.OBLIQ:e*=this.cosph0*s-this.sinph0*i*h;break;case C.EQUIT:e*=s;break;case C.N_POLE:e*=-(i*h);break;case C.S_POLE:e*=i*h;break}var r,n;return r=e*this.cg+a*this.sg,n=1/(r*this.sw*this.h1+this.cw),a=(a*this.cg-e*this.sg)*this.cw*n,e=r*n,t.x=a*this.a,t.y=e*this.a,t}function Oe(t){t.x/=this.a,t.y/=this.a;var s={x:t.x,y:t.y},i,h,a;a=1/(this.pn1-t.y*this.sw),i=this.pn1*t.x*a,h=this.pn1*t.y*this.cw*a,t.x=i*this.cg+h*this.sg,t.y=h*this.cg-i*this.sg;var e=j(t.x,t.y);if(Math.abs(e)<d)s.x=0,s.y=t.y;else{var r,n;switch(n=1-e*e*this.pfact,n=(this.p-Math.sqrt(n))/(this.pn1/e+e/this.pn1),r=Math.sqrt(1-n*n),this.mode){case C.OBLIQ:s.y=Math.asin(r*this.sinph0+t.y*n*this.cosph0/e),t.y=(r-this.sinph0*Math.sin(s.y))*e,t.x*=n*this.cosph0;break;case C.EQUIT:s.y=Math.asin(t.y*n/e),t.y=r*e,t.x*=n;break;case C.N_POLE:s.y=Math.asin(r),t.y=-t.y;break;case C.S_POLE:s.y=-Math.asin(r);break}s.x=Math.atan2(t.x,t.y)}return t.x=s.x+this.long0,t.y=s.y,t}var Be=["Tilted_Perspective","tpers"],je={init:Ie,forward:Ce,inverse:Oe,names:Be};function Le(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var t=1-this.es,s=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=s,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function Ge(t){var s=t.x,i=t.y,h,a,e,r;if(s=s-this.long0,this.shape==="ellipse"){i=Math.atan(this.radius_p2*Math.tan(i));var n=this.radius_p/j(this.radius_p*Math.cos(i),Math.sin(i));if(a=n*Math.cos(s)*Math.cos(i),e=n*Math.sin(s)*Math.cos(i),r=n*Math.sin(i),(this.radius_g-a)*a-e*e-r*r*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;h=this.radius_g-a,this.flip_axis?(t.x=this.radius_g_1*Math.atan(e/j(r,h)),t.y=this.radius_g_1*Math.atan(r/h)):(t.x=this.radius_g_1*Math.atan(e/h),t.y=this.radius_g_1*Math.atan(r/j(e,h)))}else this.shape==="sphere"&&(h=Math.cos(i),a=Math.cos(s)*h,e=Math.sin(s)*h,r=Math.sin(i),h=this.radius_g-a,this.flip_axis?(t.x=this.radius_g_1*Math.atan(e/j(r,h)),t.y=this.radius_g_1*Math.atan(r/h)):(t.x=this.radius_g_1*Math.atan(e/h),t.y=this.radius_g_1*Math.atan(r/j(e,h))));return t.x=t.x*this.a,t.y=t.y*this.a,t}function Re(t){var s=-1,i=0,h=0,a,e,r,n;if(t.x=t.x/this.a,t.y=t.y/this.a,this.shape==="ellipse"){this.flip_axis?(h=Math.tan(t.y/this.radius_g_1),i=Math.tan(t.x/this.radius_g_1)*j(1,h)):(i=Math.tan(t.x/this.radius_g_1),h=Math.tan(t.y/this.radius_g_1)*j(1,i));var o=h/this.radius_p;if(a=i*i+o*o+s*s,e=2*this.radius_g*s,r=e*e-4*a*this.C,r<0)return t.x=Number.NaN,t.y=Number.NaN,t;n=(-e-Math.sqrt(r))/(2*a),s=this.radius_g+n*s,i*=n,h*=n,t.x=Math.atan2(i,s),t.y=Math.atan(h*Math.cos(t.x)/s),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if(this.shape==="sphere"){if(this.flip_axis?(h=Math.tan(t.y/this.radius_g_1),i=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+h*h)):(i=Math.tan(t.x/this.radius_g_1),h=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+i*i)),a=i*i+h*h+s*s,e=2*this.radius_g*s,r=e*e-4*a*this.C,r<0)return t.x=Number.NaN,t.y=Number.NaN,t;n=(-e-Math.sqrt(r))/(2*a),s=this.radius_g+n*s,i*=n,h*=n,t.x=Math.atan2(i,s),t.y=Math.atan(h*Math.cos(t.x)/s)}return t.x=t.x+this.long0,t}var Te=["Geostationary Satellite View","Geostationary_Satellite","geos"],ze={init:Le,forward:Ge,inverse:Re,names:Te},xt=1.340264,_t=-.081106,gt=893e-6,vt=.003796,Bt=Math.sqrt(3)/2;function Fe(){this.es=0,this.long0=this.long0!==void 0?this.long0:0}function Qe(t){var s=x(t.x-this.long0),i=t.y,h=Math.asin(Bt*Math.sin(i)),a=h*h,e=a*a*a;return t.x=s*Math.cos(h)/(Bt*(xt+3*_t*a+e*(7*gt+9*vt*a))),t.y=h*(xt+_t*a+e*(gt+vt*a)),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function Ue(t){t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a;var s=1e-9,i=12,h=t.y,a,e,r,n,o,l;for(l=0;l<i&&(a=h*h,e=a*a*a,r=h*(xt+_t*a+e*(gt+vt*a))-t.y,n=xt+3*_t*a+e*(7*gt+9*vt*a),h-=o=r/n,!(Math.abs(o)<s));++l);return a=h*h,e=a*a*a,t.x=Bt*t.x*(xt+3*_t*a+e*(7*gt+9*vt*a))/Math.cos(h),t.y=Math.asin(Math.sin(h)/Bt),t.x=x(t.x+this.long0),t}var We=["eqearth","Equal Earth","Equal_Earth"],De={init:Fe,forward:Qe,inverse:Ue,names:We},bt=1e-10;function He(){var t;if(this.phi1=this.lat1,Math.abs(this.phi1)<bt)throw new Error;this.es?(this.en=Tt(this.es),this.m1=it(this.phi1,this.am1=Math.sin(this.phi1),t=Math.cos(this.phi1),this.en),this.am1=t/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=Xe,this.forward=Ke):(Math.abs(this.phi1)+bt>=f?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=Ve,this.forward=Je)}function Ke(t){var s=x(t.x-(this.long0||0)),i=t.y,h,a,e;return h=this.am1+this.m1-it(i,a=Math.sin(i),e=Math.cos(i),this.en),a=e*s/(h*Math.sqrt(1-this.es*a*a)),t.x=h*Math.sin(a),t.y=this.am1-h*Math.cos(a),t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function Xe(t){t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a;var s,i,h,a;if(i=j(t.x,t.y=this.am1-t.y),a=zt(this.am1+this.m1-i,this.es,this.en),(s=Math.abs(a))<f)s=Math.sin(a),h=i*Math.atan2(t.x,t.y)*Math.sqrt(1-this.es*s*s)/Math.cos(a);else if(Math.abs(s-f)<=bt)h=0;else throw new Error;return t.x=x(h+(this.long0||0)),t.y=W(a),t}function Je(t){var s=x(t.x-(this.long0||0)),i=t.y,h,a;return a=this.cphi1+this.phi1-i,Math.abs(a)>bt?(t.x=a*Math.sin(h=s*Math.cos(i)/a),t.y=this.cphi1-a*Math.cos(h)):t.x=t.y=0,t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function Ve(t){t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a;var s,i,h=j(t.x,t.y=this.cphi1-t.y);if(i=this.cphi1+this.phi1-h,Math.abs(i)>f)throw new Error;return Math.abs(Math.abs(i)-f)<=bt?s=0:s=h*Math.atan2(t.x,t.y)/Math.cos(i),t.x=x(s+(this.long0||0)),t.y=W(i),t}var Ze=["bonne","Bonne (Werner lat_1=90)"],Ye={init:He,names:Ze};function tn(t){t.Proj.projections.add(kt),t.Proj.projections.add(St),t.Proj.projections.add(Xi),t.Proj.projections.add(ha),t.Proj.projections.add(Ma),t.Proj.projections.add(pa),t.Proj.projections.add(va),t.Proj.projections.add(Pa),t.Proj.projections.add(Sa),t.Proj.projections.add(ja),t.Proj.projections.add(Ya),t.Proj.projections.add(eh),t.Proj.projections.add(Mh),t.Proj.projections.add(mh),t.Proj.projections.add(vh),t.Proj.projections.add(Ph),t.Proj.projections.add(Sh),t.Proj.projections.add(jh),t.Proj.projections.add(Fh),t.Proj.projections.add(Hh),t.Proj.projections.add(Zh),t.Proj.projections.add(ae),t.Proj.projections.add(oe),t.Proj.projections.add(fe),t.Proj.projections.add(xe),t.Proj.projections.add(Pe),t.Proj.projections.add(Se),t.Proj.projections.add(je),t.Proj.projections.add(ze),t.Proj.projections.add(De),t.Proj.projections.add(Ye)}L.defaultDatum="WGS84",L.Proj=ut,L.WGS84=new L.Proj("WGS84"),L.Point=bi,L.toPoint=ns,L.defs=wt,L.nadgrid=ei,L.transform=qt,L.mgrs=gs,L.version="__VERSION__",tn(L);var sn=L;export{sn as default};
